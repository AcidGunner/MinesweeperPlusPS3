<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_flag</spriteName>
  <solid>-1</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="2" enumb="9">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///ICELAND
if cirno9==false exit;
if instance_exists(obj_9) &amp;&amp; obj_9.stop exit;

var ix = irandom_range(1, grid_w - 2);
var iy = irandom_range(1, grid_h - 2);

while reveal[# ix, iy] = true
{
    var ix = irandom_range(1, grid_w - 2);
    var iy = irandom_range(1, grid_h - 2);
}

audio_play_sound(sfx_ice,9,false);
ds_grid_clear(iceland, 0);
iceland[# ix-1, iy-1] = 1;
iceland[# ix, iy-1] = 1;
iceland[# ix+1, iy-1] = 1;
iceland[# ix-1, iy] = 1;
iceland[# ix, iy] = 2;
iceland[# ix+1, iy] = 1;
iceland[# ix-1, iy+1] = 1;
iceland[# ix, iy+1] = 1;
iceland[# ix+1, iy+1] = 1;
alarm[9]=10*global.FSP;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="5">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>var xx = obj_9_2p.grid_x;
var yy = obj_9_2p.grid_y;

grid[# xx-1, yy-1] = -1;
grid[# xx-1, yy] = -1;
grid[# xx-1, yy+1] = -1;
grid[# xx, yy-1] = -1;
grid[# xx, yy+1] = -1;
grid[# xx+1, yy-1] = -1;
grid[# xx+1, yy] = -1;
grid[# xx+1, yy+1] = -1;
alarm[4]=1;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="4">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// === Number Fill ===
if temp_111 == 9 mine_count=0
for (var qx = 0; qx &lt; grid_w; qx++)
for (var qy = 0; qy &lt; grid_h; qy++)
{
    if circle_grid[# qx, qy]=1 reveal[# qx, qy] = true;
    
    if (grid[# qx, qy] != -1)
    {
        var c = 0;

        for (var nx = qx-1; nx &lt;= qx+1; nx++)
        for (var ny = qy-1; ny &lt;= qy+1; ny++)
        {
            if (nx &gt;= 0 &amp;&amp; ny &gt;= 0 &amp;&amp; nx &lt; grid_w &amp;&amp; ny &lt; grid_h)
            {
                if (grid[# nx, ny] == -1)
                {
                    c++;
                    if temp_111 == 9 mine_count++;
                }
            }
        }
        
        if (grid[# qx, qy] != -2) grid[# qx, qy] = c;
    }
}
if instance_exists(obj_9_2p) mine_count-=8;

if first_click &amp;&amp; boss9_started &amp;&amp; temp_111 == 9 grid[# center_x, center_y ] = 9;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="3">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>temp_x = 0;
temp_y = 0;
temp_g = 0;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Left released
var draw_size = cell_size * zoom;

check_input_2p();
var xx = msx;
var yy = msy;

temp_g = 0;


// === VALIDATION ===
if (xx &lt; 0 || yy &lt; 0 || xx &gt;= grid_w || yy &gt;= grid_h)
{
    //show_debug_message("Outside the grid?");
    temp_x=0;
    temp_y=0;
    exit; // Ignore click outside the grid
}

if circle_grid[# xx, yy] exit;
//show_debug_message(string(xx)+"-"+string(yy)+"??"+string(temp_x)+"-"+string(temp_y));

if obj_vs_ui.lost=1 exit;
if obj_game_1p.win=1 exit;
if obj_smiley_2p.mine_detected != 0 exit;
if obj_smiley_1p.mine_detected != 0 exit;
if obj_smiley_2p.cutscene == true &amp;&amp; boss9_started exit;
if obj_smiley_2p.cutscene == true &amp;&amp; boss10_started exit;
if instance_exists(obj_9_2p) &amp;&amp; obj_9_2p.stop exit;

if instance_exists(obj_9_2p) &amp;&amp; !first_click
{
    if cirno9==true &amp;&amp; iceland[# xx, yy] != 0 exit;
    
    if obj_9_2p.boss_x == xx &amp;&amp; obj_9_2p.boss_y == yy
    {
        if global.stage==910
        {
            obj_10.active=false;
            obj_10.stopped=1;
            obj_10.rand=0;
            obj_10.vspeed=0;
            obj_10.hspeed=0;
        }
        obj_9_2p.stop=1;
        obj_9_2p.active=false;
        obj_9_2p.alarm[5]=300;
        obj_smiley_2p.temp23=obj_input.mx;
        obj_smiley_2p.cutscene=true;
        obj_9_1p.stop=1;
        obj_9_1p.active=false;
        obj_smiley_1p.temp23=obj_input.mx;
        obj_smiley_1p.cutscene=true;
        audio_stop_all();
        audio_play_sound(sfx_done,0,false);
        exit;
    }
}

if instance_exists(obj_10) &amp;&amp; !first_click
{
    with obj_10
    {
        var test_dir = distance_to_point(obj_input.mx,obj_input.my);
        if test_dir&lt;7 exit;
    }
}

if temp_x==xx &amp;&amp; temp_y==yy
{
    if win == false
    {
        if (!boss9_started) &amp;&amp; temp_111 == 9
        {
            if (xx == center_x &amp;&amp; yy == center_y)
            {
                if (flagged[# xx, yy]) exit;
                // Good! Start the game
                boss9_started = true;
                audio_stop_sound(mus_ocean);
                audio_loop_sound(global._music[5],global._st[5],global._en[5],44100,0);
                obj_smiley_2p.alarm[0]=1;
                
                reveal[# xx, yy ] = true;
                
                //Just in case
                grid[# xx-1, yy-1] = -1;
                grid[# xx-1, yy] = -1;
                grid[# xx-1, yy+1] = -1;
                grid[# xx, yy-1] = -1;
                grid[# xx, yy+1] = -1;
                grid[# xx+1, yy-1] = -1;
                grid[# xx+1, yy] = -1;
                grid[# xx+1, yy+1] = -1;
                alarm[4]=1;
                
                obj_smiley_1p.alarm[0]=1;
                obj_game_1p.reveal[# xx, yy ] = true;
                obj_game_1p.boss9_started = true;
                obj_game_1p.grid[# xx-1, yy-1] = -1;
                obj_game_1p.grid[# xx-1, yy] = -1;
                obj_game_1p.grid[# xx-1, yy+1] = -1;
                obj_game_1p.grid[# xx, yy-1] = -1;
                obj_game_1p.grid[# xx, yy+1] = -1;
                obj_game_1p.grid[# xx+1, yy-1] = -1;
                obj_game_1p.grid[# xx+1, yy] = -1;
                obj_game_1p.grid[# xx+1, yy+1] = -1;
                obj_game_1p.alarm[4]=1;
            }
            else
            {
                // Wrong square — clicking does nothing
                show_debug_message("!! Must click boss center tile first");
                exit;
            }
            
            exit; // first click handled
        }
        
        if (!boss10_started) &amp;&amp; global.stage==10
        {
            if (xx == center_x &amp;&amp; yy == center_y)
            {
                if (flagged[# xx, yy]) exit;
                // Good! Start the game
                boss10_started = true;
                audio_stop_sound(mus_ocean);
                audio_loop_sound(global._music[11],global._st[11],global._en[11],44100,0);
                obj_smiley_2p.alarm[5]=1;
                
                reveal[# xx, yy ] = true;
                grid[# xx, yy] = 10;
            }
            else
            {
                // Wrong square — clicking does nothing
                show_debug_message("!! Must click boss center tile first");
                exit;
            }
            
            exit; // first click handled
        }
        
        // === Safe First Click ===
        if (first_click)
        {
            first_click = false;
            
            // If the first clicked cell is a mine, rebuild the board
            if (grid[# xx, yy] == -1)
            {
                if !((xx == center_x or xx == center_x+1 or xx == center_x-1)
                and (yy == center_y or yy == center_y+1 or yy == center_y-1))
                and global.stage==9
                regenerate_grid(xx, yy, temp_mines);
            }
            
            if temp_111 == 9
            {
                obj_9_1p.active=true;
                obj_9_2p.active=true;
                reveal[# obj_9_1p.boss_x, obj_9_1p.boss_y ] = false;
                reveal[# obj_9_2p.boss_x, obj_9_1p.boss_y ] = false;
                alarm[9]=1;
                alarm[4]=1;
                obj_game_2p.alarm[9]=1;
                obj_game_2p.alarm[4]=1;
            }
            else if global.stage==10
            {
                audio_stop_all();
                audio_loop_sound(global._music[12],global._st[12],global._en[12],44100,0);
                obj_10.active=true;
                obj_10.time=11;
                obj_10.alarm[3]=1;
            };
            //if global.stage!=910 obj_ui.alarm[0]=1;
        }
        
        var cell = grid[# xx, yy];
        
        // If the clicked cell is already revealed AND is a number → try neighbor open
        if (reveal[# xx, yy] &amp;&amp; cell &gt; 0)
        {
            scr_open_neighbors(xx, yy);
            if temp_111!=9 scr_check_win();
        }
        else
        {
            // original reveal behavior
            if (!flagged[# xx, yy])
            {
                if (cell == -1)
                {
                    scr_mine_detected_2p();
                    src_reveal_mine(xx, yy);
                }
                else
                {
                    scr_reveal(xx, yy);
                    if temp_111!=9 scr_check_win();
                }
            }
        }
    }
}

temp_x=0;
temp_y=0;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Right Clicked
var draw_size = cell_size * zoom;

check_input_2p();
var xx = msx;
var yy = msy;

temp_g = 1;
temp_x = xx;
temp_y = yy;

// === VALIDATION ===
if (xx &lt; 0 || yy &lt; 0 || xx &gt;= grid_w || yy &gt;= grid_h) exit;
if circle_grid[# xx, yy] exit;

if obj_vs_ui.lost=1 exit;
if obj_game_1p.win=1 exit;
if obj_smiley_2p.mine_detected != 0 exit;
if obj_smiley_1p.mine_detected != 0 exit;
if obj_smiley_2p.cutscene == true &amp;&amp; boss9_started exit;
if obj_smiley_2p.cutscene == true &amp;&amp; boss10_started exit;
if instance_exists(obj_9_2p) &amp;&amp; obj_9_2p.stop exit;

if win == false
{
    if cirno9=true &amp;&amp; iceland[# xx, yy] != 0 exit;
    
    if (xx &gt;= 0 &amp;&amp; yy &gt;= 0 &amp;&amp; xx &lt; grid_w &amp;&amp; yy &lt; grid_h)
    {
        // Toggle flag only if not revealed
        if (!reveal[# xx, yy])
        {
            flagged[# xx, yy] = !flagged[# xx, yy];
            the_temp = flagged[# center_x, center_y];
            if flagged[# xx, yy] == 0
            {
                audio_play_sound(sfx_unflag,4,false);
                mines_left++;
            }
            if flagged[# xx, yy] == 1
            {
                audio_play_sound(sfx_flag,4,false);
                mines_left--;
            }
        }
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Left clicked

var draw_size = cell_size * zoom;

check_input_2p();
temp_x = msx;
temp_y = msy;

temp_g = 1;

// === VALIDATION ===
if (temp_x &lt; 0 || temp_y &lt; 0 || temp_x &gt;= grid_w || temp_y &gt;= grid_h) exit;
if circle_grid[# temp_x, temp_y] exit;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Main stuff
image_speed=0.02;
test_speed+=0.08;

off_x-=obj_input.p2_cursor_rx;
off_y-=obj_input.p2_cursor_ry;
if obj_input.p2_cursor_r{off_x=0;off_y=0;};

// Reset highlight
highlight_x1 = -1;
highlight_y1 = -1;
highlight_x2 = -1;
highlight_y2 = -1;

if global.stage==9 or global.stage==10 let_me_out();

check_input_2p();
checks_input_2p();
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Spiral weeeeee
if temp_111 != 9 exit;

if spiral_go == true &amp;&amp; (spiral_index &lt; ds_list_size(spiral))
{
    var v  = ds_list_find_value(spiral, spiral_index);
    var xx = v &gt;&gt; 16;
    var yy = v &amp; $FFFF;

    // Switch to your new sprite
    grid_sprite[# xx, yy] = t9_grid;
    
    spiral_index += 1;
}
else if spiral_go == true
{
    //obj_bg.sprite_index=t9_grid;
    for (var xx = 0; xx &lt; grid_w; xx++)
    for (var yy = 0; yy &lt; grid_h; yy++)
    {
        grid_sprite[# xx, yy] = t9_grid; // default sprite
    }
    spr_bgb=t9_gridb;
    spiral_go = false;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>draw_set_alpha(1);
draw_grid();
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
